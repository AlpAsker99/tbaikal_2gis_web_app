<!DOCTYPE html>
<html>
<head>
    <title>2GIS Map Picker</title>
    <script src="https://maps.api.2gis.ru/2.0/loader.js?pkg=full"></script>
</head>
<body>
    <div id="map" style="width: 100%; height: 400px;"></div>
    <script>
        DG.then(function() {
            const map = DG.map('map', { center: [54.98, 82.89], zoom: 13 });
            let marker;

            map.on('click', function(e) {
                if (marker) map.removeLayer(marker);
                marker = DG.marker([e.latlng.lat, e.latlng.lng]).addTo(map);
                
                // Send data back to Telegram
                Telegram.WebApp.sendData(JSON.stringify({
                    lat: e.latlng.lat,
                    lon: e.latlng.lng,
                    address: "Selected location (fetch via 2GIS API if needed)"
                }));
            });
        });
    </script>
</body>
</html>